<Window x:Class="Wpf_RunVision.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:Release="clr-namespace=VMControls.WPF.Release;assembly=VMControls.WPF"
        xmlns:vm="clr-namespace:Wpf_RunVision.ViewModels"
        mc:Ignorable="d"
        Title="RunVision"
        MinHeight="450"
        MinWidth="800"
        Height="800" Width="1300"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closed">
            <i:InvokeCommandAction Command="{Binding WindowClosedCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <MenuItem Header="软件设置" IsEnabled="{Binding CanEditScheme}">
                <MenuItem Style="{x:Null}" Header="方案配置" Command="{Binding OpenSchemeCommand}"/>
            </MenuItem>

            <MenuItem Header="{Binding CurrentPermission}" Command="{Binding TogglePermissionCommand}" />

            <MenuItem Header="{Binding CurrentScheme}">
                <MenuItem.ItemsSource>
                    <Binding Path="Schemes"/>
                </MenuItem.ItemsSource>
                <MenuItem.ItemContainerStyle>
                    <Style TargetType="MenuItem">
                        <Setter Property="Header" Value="{Binding}" />
                        <Setter Property="Command" 
                    Value="{Binding DataContext.SwitchSchemeCommand, RelativeSource={RelativeSource AncestorType=Window}}" />
                        <Setter Property="CommandParameter" Value="{Binding}" />
                    </Style>
                </MenuItem.ItemContainerStyle>
            </MenuItem>

        </Menu>

        <Grid Grid.Row="1" Background="{DynamicResource {x:Static SystemColors.MenuBrushKey}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0">
                <ContentControl Content="{Binding FrontendControl}" />
            </Border>

            <GridSplitter Grid.Column="1"
                          Width="1"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          ResizeDirection="Columns"
                          ResizeBehavior="PreviousAndNext"
                          Background="Transparent"
                          ShowsPreview="True"/>

            <hc:SimplePanel Grid.Column="2" Margin="2,0,2,0"
                            Background="{DynamicResource RegionBrush}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="250"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Margin="0,2,0,2"
                            BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}"
                            Background="{DynamicResource RegionBrush}"
                            CornerRadius="4"/>

                    <Border Grid.Row="1" Margin="0,0,0,2"
                            BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}"
                            Background="{DynamicResource RegionBrush}"
                            CornerRadius="4">
                    <RichTextBox x:Name="LogRichTextBox"
                                     BorderThickness="0"
                                     IsReadOnly="True"
                                     VerticalScrollBarVisibility="Auto"/>
                    </Border>

                </Grid>
            </hc:SimplePanel>

        </Grid>
    </Grid>
</Window>
