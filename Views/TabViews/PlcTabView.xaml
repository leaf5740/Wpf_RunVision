<UserControl 
    x:Class="Wpf_RunVision.Views.TabViews.PlcTabView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:vm="clr-namespace:Wpf_RunVision.ViewModels.TabViewModels" 
    xmlns:hc="https://handyorg.github.io/handycontrol"
    mc:Ignorable="d">

    <UserControl.DataContext>
        <vm:PlcTabViewModel/>
    </UserControl.DataContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- 左侧、右侧占位 -->
        <GroupBox Grid.Column="0" Header="读取地址" Style="{StaticResource GroupBoxTab}">
            <DataGrid Grid.Column="0"
                      HeadersVisibility="All"
                      RowHeaderWidth="35"
                      hc:DataGridAttach.ShowRowNumber="True"
                      AutoGenerateColumns="False"
                      CanUserSortColumns="False"
                      ItemsSource="{Binding ReadPLCAddress}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Name}" Header="名称" IsReadOnly="True"/>
                    <DataGridTextColumn Binding="{Binding Address}" Header="地址"/>
                    <DataGridTextColumn Binding="{Binding Value}" Header="值"/>
                    <DataGridTextColumn Binding="{Binding Remark}" Header="备注"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
        
        <GroupBox Grid.Column="1" Header="写入地址"  Style="{StaticResource GroupBoxTab}">
            <DataGrid Grid.Column="0"
                  HeadersVisibility="All"
                  RowHeaderWidth="35"
                  hc:DataGridAttach.ShowRowNumber="True"
                  AutoGenerateColumns="False"
                  CanUserSortColumns="False"
                  ItemsSource="{Binding WritePLCAddress}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Name}" Header="名称" IsReadOnly="True"/>
                    <DataGridTextColumn Binding="{Binding Address}" Header="地址"/>
                    <DataGridTextColumn Binding="{Binding Value}" Header="值"/>
                    <DataGridTextColumn Binding="{Binding Remark}" Header="备注"/>
                </DataGrid.Columns>
            </DataGrid>



        </GroupBox>

        <!-- 右侧PLC配置 -->
        <Grid Grid.Column="2" Margin="30,15,30,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- 通讯协议 -->
            <ComboBox 
                Grid.Row="0"
                hc:InfoElement.Title="通讯协议:"
                ItemsSource="{Binding AvailableProtocols}"
                SelectedItem="{Binding SelectedProtocol, Mode=TwoWay}"
                Style="{StaticResource ComboBoxExtend}"
                Margin="0,0,0,10"/>
            
            <!-- PLC品牌 -->
            <ComboBox 
                Grid.Row="1"
                hc:InfoElement.Title="PLC品牌:"
                ItemsSource="{Binding PlcBrands}"
                SelectedItem="{Binding SelectedBrand, Mode=TwoWay}"
                Style="{StaticResource ComboBoxExtend}"
                Margin="0,0,0,10"/>



            <!-- IP -->
            <TextBox 
                Grid.Row="2"
                hc:InfoElement.Title="PLC_IP地址:"
                Text="{Binding PlcConfig.Ip, Mode=TwoWay}"
                Style="{StaticResource TextBoxExtend}"
                Margin="0,0,0,10"/>

            <!-- Port -->
            <TextBox 
                Grid.Row="3"
                hc:InfoElement.Title="PLC_端口号:"
                Text="{Binding PlcConfig.Port, Mode=TwoWay}"
                Style="{StaticResource TextBoxExtend}"
                Margin="0,0,0,10"/>
            
            <!-- 分隔线 -->
            <hc:Divider 
                Grid.Row="4"
                LineStrokeThickness="1"
                Orientation="Horizontal"
                Margin="0,0,0,10"/>
            
            <!-- 连接测试按钮 -->
            <Button 
                Grid.Row="5"
                Height="40"
                Content="PLC连接测试"
                Command="{Binding ConnectCommand}"
                HorizontalAlignment="Stretch"
                Margin="0,0,0,10"/>

            <!-- 保存配置按钮 -->
            <Button 
                Height="40"
                Grid.Row="6"
                Content="保存配置"
                Command="{Binding SaveConfigCommand}"
                HorizontalAlignment="Stretch"/>
        </Grid>
    </Grid>
</UserControl>
